# Транзакционная модель блокчейна

## Агрегация данных

Агрегируем данные о swap-контрактах. Почитать про API можно тут https://thegraph.com/docs/en/token-api/svm-dexs/swaps/

Для пользователей без подписки есть возможность читать данные батчами по 10 транзакций. Поэтому написан несложный скрипт с пагинацией, который читает все записи по блокам последовательно. Происходит это почти в реальном времени, потому что, насколько я понял, старые данные долго не хранятся. 

Все полученные данные сохраняются в таблицу. В качестве локальной бд для просто используется Sqlite3. Загрузчик можно выключить в любой момент времени, а потом заново включить обратно, чтение продолжится с того же места. Код покрыт обработчиками ошибок, если что-то происходит с сетью, запросы будут ретраиться. Так что данные можно оставлять загружаться на ночь.

Запускается загрузка:

``` shell
python -m src.data_downloader
```

Если нужно изменить номер блока, с которого начинается чтение, то это нужно делать руками в базе данных.

## Генерация данных

Данные генерируются в следующей модели: создается набор из $n$ коинов и $m$ аккаунтов. Каждому коину присваивается условная стоимость в usd. У каждого аккаунта создается портфель из всех коинов. 

Последовательно генерируются транзакции. 

Генерация транзакций происходит на основе модели транзакций. На данный момент модель принимает условные стоимости коинов и данные аккаунтов и генерурует следующую транзакцию. Генераторы можно менять и усложнять модель.

Ценообразование происходит последовательно вместе с изменением timestamp на основе модели. На данный момент просто изменяется с шумом. Можно усложнять модель и писать разные генераторы.

Пример:

``` shell
python -m src.dataset
```